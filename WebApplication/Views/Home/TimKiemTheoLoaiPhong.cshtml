@model IEnumerable<WebApplication.Entities.Room>

<style>
    .imgSize {
        width: 100% !important;
        height: 300px !important;
        background-repeat: no-repeat;
        padding-bottom: 10px;
    }

    .modal-content {
        padding-bottom: 20px;
    }

    ul {
        display: inline-block;
        text-align: left;
    }
</style>

@foreach (var item in Model)
{
    <div class="row margin-bottom">
        <div class="col-md-5">
            @{
                String url = "\\" + item.Image.Replace("\\", "/");
            }

            <img class="imgSize" src=@url />
        </div>


        <div class="col-sm-7">
            <div class="row">
                <div class="col-sm-4">
                    @{
                        String loaiPhong = item.RoomType.Name;
                        String maPhong = item.RoomID;

                    }
                    <h4 style="color: deeppink">@loaiPhong</h4>
                </div>
                <div class="col-sm-4">
                    <h4 style="color: blueviolet">@Html.DisplayFor(modelItem => item.RoomID)</h4>
                </div>
                <div class="col-sm-4" style="color: #00a7d0">
                    &euro; @Html.DisplayFor(modelItem => item.RentalPrice)<span>&thinsp; &thinsp; a night</span>
                </div>
            </div>
            <div class="row">
                <p style="text-align:left; padding-left:10px;">
                    <i>
                        " With a friendly design anh perfect. With many room service<br />
                        attached will give you the feeling of being at home."
                    </i>
                </p>
            </div>
            <div class="row margin-bottom">
                <div class="col-xs-6">
                    <ul class="list-unstyled">
                        <li><i class="fa fa-check-circle" style="color: #00a7d0"></i> Incl. breakfast</li>
                        <li><i class="fa fa-check-circle" style="color: #00a7d0"></i> Private balcony</li>
                        <li><i class="fa fa-check-circle" style="color: #00a7d0"></i> Skynight view</li>
                    </ul>
                </div>
                <div class="col-xs-6">
                    <ul class="list-unstyled">
                        <li><i class="fa fa-check-circle" style="color: #00a7d0"></i> Free Wi-Fi</li>
                        <li><i class="fa fa-check-circle" style="color: #00a7d0"></i> Spa</li>
                        <li><i class="fa fa-check-circle" style="color: #00a7d0"></i> Bathroom</li>
                    </ul>
                </div>
            </div>
            <div class="row">
                <button type="button" class="btn btn-info" onclick="booking('@loaiPhong','@maPhong')"> BOOKING </button>
            </div>

        </div>
    </div>
                        }

<!--Modal DoubleRoom-->

<div class="modal fade" id="myModal_Double" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="login-box-body">
                <h3 class="login-box-msg" style="text-align:center">Double Room</h3>
                <form>
                    <div class="box box-primary">
                        <div class="box-header">
                            <h4 class="modal-title">Double form</h4>
                            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>

                        </div>
                        <div class="box-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <input value="CheckCustomerID" type="button" id="btn_checkMember_2" onclick="checkMember_2()" /><br />
                                    <div><input type="text" id="txt_CusID_2" hidden onblur="checkText_2()" /></div>
                                    <div class="form-group">
                                        <label>Select View</label>
                                        <select class="form-control select2" id="sel_view_2" style="width: 200%;">
                                            <option selected="selected">Not Prefer</option>
                                            <option>Sunrise</option>
                                            <option>Sea</option>
                                            <option>Nightlife</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Room Code</label>

                                        <input name="Maphong" class="form-control" type="text" id="txt_roomCode_2" readonly />

                                    </div>
                                    <div class="form-group">
                                        <label>Select the number of person</label>
                                        <select class="form-control select2" id="sel_Person_2" style="width: 40%;">
                                            <option selected="selected">1</option>
                                            <option>2</option>
                                            <option>3</option>
                                            <option>4</option>
                                        </select>
                                    </div>

                                    <div class="form-group has-feedback">
                                        <input type="text" id="txt_Name_2" name="Name" class="form-control" placeholder="Fullname" required
                                               pattern="[a-zz A-Z]{5,}" title="Please fill out this field">
                                    </div>
                                    <div class="form-group">
                                        Sex <br />
                                        <input name="client_gender" type="radio" value="1" id="rad_male_2" checked="checked" />Male
                                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                        <input name="client_gender" value="0" type="radio" id="rad_female_2" />Female

                                    </div>
                                    <div class="form-group">
                                        <label>Phone Number</label>
                                        <input class="form-control" id="txt_Phone_2" name="Phone" type="text" size="50%"
                                               pattern="(09|01)[0-9]{8,9}" title="Invalid Phone Number">
                                    </div>
                                    <div class="form-group">
                                        <label>Email Adrress</label>
                                        <input class="form-control" id="Email_2" name="Email" type="email" size="50%"
                                               required title="Invalid Email">
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Check In</label>

                                <div class="input-group date">
                                    <div class="input-group-addon">
                                        <i class="fa fa-calendar"></i>
                                    </div>
                                    <input required type="date" id="ngaydat_2">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Check Out</label>

                                <div class="input-group">
                                    <div class="input-group-addon">
                                        <i class="fa fa-calendar"></i>
                                    </div>
                                    <input type="date" id="ngaytra_2">
                                </div>
                            </div>
                            <span class="input-group-btn">
                                <input type="button" onclick="bookingConfirm(2)" style="border-color: gold" class="btn btn-flat" value="Confirm"/>
                            </span>
                            <span class="input-group-btn">
                                <a href="/Home/Pay" name="submit" id="pay-btn_2" style="border-color: lightgreen "
                                   class="btn btn-flat">
                                    Pay
                                </a>
                            </span>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>


<!--Modal SingleRoom-->

<div class="modal fade" id="myModal_Single" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="login-box-body">
                <form>
                    <div class="box box-primary">
                        <div class="box-header">
                            <h4 class="modal-title">Single form</h4>
                            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        </div>
                        <div class="box-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <input value="CheckCustomerID" type="button" id="btn_checkMember_1" onclick="checkMember_1() " /><br />
                                    <div><input type="text" id="txt_CusID_1" hidden onblur="CheckText_1()" /></div><br />
                                    <div class="form-group">
                                        <label>Select View</label>
                                        <select class="form-control select2" id="sel_view_1" style="width: 200%;">
                                            <option selected="selected">Not Prefer</option>
                                            <option>Sunrise</option>
                                            <option>Sea</option>
                                            <option>Nightlife</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Room Code</label>
                                        <input class="form-control" type="text" id="txt_roomCode_1" readonly />
                                    </div>
                                    <div class="form-group">
                                        <label>Select the number of person</label>
                                        <select class="form-control select2" id="sel_person_1" style="width: 40%;">
                                            <option selected="selected">1</option>
                                            <option>2</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Name</label>
                                        <input class="form-control" required name="client_fullname" id="txt_Name_1" type="text" style="width: 200%"
                                               pattern="[a-zA-Z ]{5,}" title="At least 5 characters, no special symbols">
                                    </div>
                                    <div class="form-group">
                                        Sex <br />
                                        <input name="client_gender" id="rad_male_1" type="radio" checked="checked">Male
                                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                        <input name="client_gender" id="rad_female_1" type="radio">Female

                                    </div>
                                    <div class="form-group">
                                        <label>Phone Number</label>
                                        <input class="form-control" id="txt_Phone_1" required name="client_phonenumber" type="text" style="width: 200%"
                                               pattern="(09|01)[0-9]{8,9}" title="Invalid Phone Number">
                                    </div>
                                    <div class="form-group">
                                        <label>Email Adrress</label>
                                        <input id="Email_1" class="form-control" name="client_email" type="email" style="width: 200%"
                                               required title="Invalid Email">
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Check In</label>

                                <div class="input-group date">
                                    <div class="input-group-addon">
                                        <i class="fa fa-calendar"></i>
                                    </div>
                                    <input required type="date" id="ngaydat_1">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Check Out</label>

                                <div class="input-group">
                                    <div class="input-group-addon">
                                        <i class="fa fa-calendar"></i>
                                    </div>
                                    <input type="date" id="ngaytra_1">
                                </div>
                            </div>
                            <span class="input-group-btn">
                                <input type="button" style="border-color: gold" class="btn btn-flat" onclick="bookingConfirm(1)" value="Confirm"/>
                            </span>
                            <span class="input-group-btn">
                                <a href="/Home/Pay" name="submit" id="pay-btn_1" style="border-color: lightgreen "
                                   class="btn btn-flat" onclick="datphong()">
                                    Pay
                                </a>
                            </span>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    //DoubleRoom
    //checkMember_2
    function checkMember_2() {
        console.log(typeof document.getElementById("txt_CusID_2").value)
      //  if (document.getElementById("txt_CusID_2").value.length <= 0) {
        if (document.getElementById("btn_checkMember_2").value == 'CheckCustomerID') {
                document.getElementById("txt_CusID_2").hidden = false;

                document.getElementById("btn_checkMember_2").value = 'Cancel';
            }
            else {
                document.getElementById("txt_CusID_2").value = "";
                document.getElementById("txt_CusID_2").hidden = true;

                document.getElementById("btn_checkMember_2").value = 'CheckCustomerID';
                //Tra lai trang thai ban dau cho cac fields khac
                document.getElementById("txt_CusID_2").value = "";
                document.getElementById("txt_Phone_2").value = "";
                document.getElementById("txt_Phone_2").readOnly = false;
                document.getElementById("Email_2").value = "";
                document.getElementById("Email_2").readOnly = false;
                document.getElementById("txt_Name_2").value = "";
                document.getElementById("txt_Name_2").readOnly = false;
                document.getElementsByName("client_gender").checked = false;
      //      }
        }

    }
    //<!--Onblur DoubleRoom-->
    //CheckText_2
    function checkText_2() {
        let customerId = document.getElementById("txt_CusID_2").value;
        if (customerId != "") {
            $.ajax({
                method: 'GET',
                dataType: 'json',
                url: '/CustomerTVs/GetCustomerById',
                data: {
                    customerId: customerId
                }
            }).done(
                function (response) {

                    console.log(response);
                    //{CustomerId: 1, Name: "Thu Thuong", Phone: "01365897755", Email: "thuong@gmail", Gender: false}
                    document.getElementById("txt_Phone_2").value = response.Phone;
                    document.getElementById("txt_Phone_2").readOnly = true;
                    document.getElementById("txt_Name_2").value = response.Name;
                    document.getElementById("txt_Name_2").readOnly = true;
                    document.getElementById("Email_2").value = response.Email;
                    document.getElementById("Email_2").readOnly = true;
                    //Set gioi tinh
                    document.getElementById("rad_female_2").checked = !response.Gender;
                    document.getElementById("rad_male_2").checked = response.Gender;
                })
                .fail(function (error) {
                    // conole.log(error);
                    alert('Error :((');

                })
        } else {
            checkMember_2();
        }
       
    }

    //SingleRoom
    //checkMember_1
    function checkMember_1() {
        console.log(typeof document.getElementById("txt_CusID_1").value)
      //  if (document.getElementById("txt_CusID_1").value == "") {
            //console.log(typeof document.getElementById("btn_checkMember_1").value)
            if (document.getElementById("btn_checkMember_1").value == 'CheckCustomerID') {
                document.getElementById("txt_CusID_1").hidden = false;
                document.getElementById("btn_checkMember_1").value = 'Cancel';
            }
            else {
                document.getElementById("txt_CusID_1").value = "";
                document.getElementById("txt_CusID_1").hidden = true;

                document.getElementById("btn_checkMember_1").value = 'CheckCustomerID';
                //Tra lai trang thai ban dau cho cac fields khac
                document.getElementById("txt_CusID_1").value = "";
                document.getElementById("txt_Phone_1").value = "";
                document.getElementById("txt_Phone_1").readOnly = false;
                document.getElementById("Email_1").value = "";
                document.getElementById("Email_1").readOnly = false;
                document.getElementById("txt_Name_1").value = "";
                document.getElementById("txt_Name_1").readOnly = false;
                document.getElementsByName("client_gender").checked = false;
     //       }
        }

    }
    //<!--Onblur Single Room-->
    //CheckText_1
    function CheckText_1() {
        let customerId = document.getElementById("txt_CusID_1").value;
        if (customerId != "") {
            $.ajax({
                method: 'GET',
                dataType: 'json',
                url: '/CustomerTVs/GetCustomerById',
                data: {
                    customerId: customerId
                }
            }).done(
                function (response) {

                    console.log(response);
               
                    document.getElementById("txt_Phone_1").value = response.Phone;
                    document.getElementById("txt_Phone_1").readOnly = true;
                    document.getElementById("txt_Name_1").value = response.Name;
                    document.getElementById("txt_Name_1").readOnly = true;
                    document.getElementById("Email_1").value = response.Email;
                    document.getElementById("Email_1").readOnly = true;
                    //Set gioi tinh
                    document.getElementById("rad_female_1").checked = !response.Gender;
                    document.getElementById("rad_male_1").checked = response.Gender;
                })
                .fail(function (error) {
                    // conole.log(error);
                    alert('Error :((');

                })
        } else {
            checkMember_1();
        }
        
    }

    //RoomCode
    function booking(loai, maPhong) {


        if (loai == 'SINGLE') {
            $("#txt_roomCode_1").val(maPhong);
            $("#myModal_Single").modal('show');

        }
        else {
            $("#txt_roomCode_2").val(maPhong);
            $("#myModal_Double").modal('show');
        }

    }

    //CheckModal
    function datphong() {
        if (document.getElementById('myModal_Double').getAttribute('aria-hidden') == true) {
            if (document.getElementById('txt_roomCode_2').value == "Room Code")
                alert('Please enter the information !!!');
            else
                alert('Reservation successful !!!');
        }
        else if (document.getElementById('myModal_Single').getAttribute('aria-hidden') == true) {
            if (document.getElementById('txt_roomCode_1').value == "Room Code")
                alert('Please enter the information !!!');
            else
                alert('Reservation successful !!!');
        }


    }

	function bookingConfirm(loai) {
        let data = {
            RoomBookingID: "",
            CustomerID: "",
            Person: "",
            RoomID: "",
            Name: "",
            Phone: "",
            Email: "",
            CheckinDate: "",
            CheckoutDate: "",
            EmployeeID: "NV001"
        }
        if (loai == 1) {
            let ingayDat = new Date($('#ngaydat_1').val());
			let ingatTra = new Date($('#ngaytra_1').val());
			//alert(ingayDat.getDate() + '/' + (ingayDat.getMonth() + 1) + '/' + ingayDat.getFullYear() + " \n" + ingatTra.getDate() + '/' + (ingatTra.getMonth() + 1) + '/' + ingatTra.getFullYear());
            //Get data
            data.Person = $('#sel_person_1').find(":selected").text();
            data.RoomID = $('#txt_roomCode_1').val();
            data.Name = $('#txt_Name_1').val();
            data.Phone = $('#txt_Phone_1').val();
			data.Email = $('#Email_1').val();
			data.CheckinDate = ingayDat.toISOString();
			data.CheckoutDate = ingatTra.toISOString();
        } else {
            let ingayDat = new Date($('#ngaydat_2').val());
			let ingatTra = new Date($('#ngaytra_2').val());
			//alert(ingayDat.getDate() + '/' + (ingayDat.getMonth() + 1) + '/' + ingayDat.getFullYear() + " \n" + ingatTra.getDate() + '/' + (ingatTra.getMonth() + 1) + '/' + ingatTra.getFullYear());
            data.Person = $('#sel_Person_2').find(":selected").text();
            data.RoomID = $('#txt_roomCode_2').val();
            data.Name = $('#txt_Name_2').val();
            data.Phone = $('#txt_Phone_2').val();
			data.Email = $('#Email_2').val();
			data.CheckinDate = ingayDat.toISOString();
			data.CheckoutDate = ingatTra.toISOString();
        }

        console.log(data)

        $.ajax({
            method: 'post',
            url: '/RoomBookings/CreateJSON',
            data: data
        }).done(function (response) {
            console.log(response);
            if (response.status == true) {
                var roomBookingId = response.roomBookingID;
                var detailUrl = "/RoomBookings/Details/" + roomBookingId;
                window.location.href = detailUrl;
                //RoomBookings / Details / 
            } else {
                alert('Failure !!!')
            }
            console.log(response);
            }).fail(function (error) {
                alert('Error :((')
             console.log(error);
        })
    }

</script>

